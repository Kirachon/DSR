package ph.gov.dsr.security.dto;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;
import ph.gov.dsr.security.entity.VulnerabilitySeverity;

import java.time.LocalDateTime;

/**
 * DTO for web application vulnerabilities
 * 
 * @author DSR Development Team
 * @version 3.0.0
 * @since 2024-12-28
 */
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class WebVulnerability {

    private String id;
    private String name;
    private String description;
    private VulnerabilitySeverity severity;
    private String url;
    private String method;
    private String parameter;
    private String evidence;
    private String solution;
    private String reference;
    private String cweId;
    private String wascId;
    private Double riskScore;
    private Double confidenceScore;
    private String attackVector;
    private String payload;
    private String response;
    private String category;
    private Boolean falsePositive;
    private LocalDateTime detectedAt;
    private String sourceFile;
    private Integer lineNumber;
    private String riskDescription;
    private String impactDescription;
    private String remediationEffort;
    private String tags;
    
    /**
     * Check if this vulnerability is high severity
     */
    public boolean isHighSeverity() {
        return severity == VulnerabilitySeverity.HIGH || severity == VulnerabilitySeverity.CRITICAL;
    }
    
    /**
     * Check if this vulnerability is critical
     */
    public boolean isCritical() {
        return severity == VulnerabilitySeverity.CRITICAL;
    }
    
    /**
     * Check if this vulnerability requires immediate attention
     */
    public boolean requiresImmediateAttention() {
        return isCritical() || (riskScore != null && riskScore >= 8.0);
    }
}
